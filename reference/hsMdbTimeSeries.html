<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Get Mdb time series in UTC — hsMdbTimeSeries • kwb.db</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Get Mdb time series in UTC — hsMdbTimeSeries"><meta property="og:description" content="Reads time-series data from an MS Access database table and returns a data
frame containing the data. The name of the timestamp field must be given in
tsField and the names of the value fields to be selected from the
table must be given in vector fields. Instead of an ODBC channel the
name of the database must be given. This function takes care that the
timestamps are transferred correctly between MS Access and R by requesting
date and time information separately from MS Access and putting both together
to a POSIXct object in UTC timezone. This is necessary because with very long
data sets the RODBC function sqlQuery (or the function
hsSqlQuery that calls this function) may deliver timestamps in
which time information is lacking!"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">kwb.db</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/KWB-R/kwb.db/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get Mdb time series in UTC</h1>
    <small class="dont-index">Source: <a href="https://github.com/KWB-R/kwb.db/blob/HEAD/R/main.R" class="external-link"><code>R/main.R</code></a></small>
    <div class="hidden name"><code>hsMdbTimeSeries.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Reads time-series data from an MS Access database table and returns a data
frame containing the data. The name of the timestamp field must be given in
<em>tsField</em> and the names of the value fields to be selected from the
table must be given in vector <em>fields</em>. Instead of an ODBC channel the
name of the database must be given. This function takes care that the
timestamps are transferred correctly between MS Access and R by requesting
date and time information separately from MS Access and putting both together
to a POSIXct object in UTC timezone. This is necessary because with very long
data sets the RODBC function sqlQuery (or the function
<code><a href="hsSqlQuery.html">hsSqlQuery</a></code> that calls this function) may deliver timestamps in
which time information is lacking!</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">hsMdbTimeSeries</span><span class="op">(</span>
  <span class="va">mdb</span>,
  <span class="va">tbl</span>,
  tsField <span class="op">=</span> <span class="fu"><a href="hsTsField.html">hsTsField</a></span><span class="op">(</span><span class="va">mdb</span>, <span class="va">tbl</span><span class="op">)</span>,
  fields <span class="op">=</span> <span class="st">"*"</span>,
  minDate <span class="op">=</span> <span class="cn">NULL</span>,
  maxDate <span class="op">=</span> <span class="cn">NULL</span>,
  resolution <span class="op">=</span> <span class="st">"min"</span>,
  inclLast <span class="op">=</span> <span class="cn">TRUE</span>,
  sqlFilter <span class="op">=</span> <span class="st">"TRUE"</span>,
  dbg <span class="op">=</span> <span class="cn">FALSE</span>,
  calcType <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mdb</dt>
<dd><p>Full path to MS Access database file (*.mdb)</p></dd>
<dt>tbl</dt>
<dd><p>Name of table containing the time-series data.</p></dd>
<dt>tsField</dt>
<dd><p>Name of table field containing the timestamps.</p></dd>
<dt>fields</dt>
<dd><p>Vector containing names of value fields to be selected from the
table. This vector may or may not contain the name of the timetamp field.</p></dd>
<dt>minDate</dt>
<dd><p>Minimum date (and time) of time interval to be selected in
ISO-Syntax: yyyy-mm-dd [HH:MM:SS], where the part in brackets in optional.</p></dd>
<dt>maxDate</dt>
<dd><p>Day following the maximum date of the time interval to be
selected, in ISO-Syntax: yyyy-mm-dd [HH:MM:SS], where the part in brackets
in optional.</p></dd>
<dt>resolution</dt>
<dd><p>time resolution: “min” = minutes, “s” =
seconds. If time resolution is “min” timestamps are rounded to the
next full minute.</p></dd>
<dt>inclLast</dt>
<dd><p>If TRUE, <em>maxDate</em> will be included in result data set,
else excluded.</p></dd>
<dt>sqlFilter</dt>
<dd><p>additional SQL filter criterion</p></dd>
<dt>dbg</dt>
<dd><p>if TRUE, debug messages are shown</p></dd>
<dt>calcType</dt>
<dd><p>for internal use only, do not change!</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>data.frame with POSIXct timestamp column &lt;strTimestamp&gt; (UTC time
  zone) and value columns as selected in &lt;strFieldList&gt;</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="hsGetTimeSeries.html">hsGetTimeSeries</a>, <a href="hsGetTable.html">hsGetTable</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co">## Get flow time series of 24 of August 2011 from tbl_Hyd in example database</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"windows"</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu">hsMdbTimeSeries</span><span class="op">(</span></span>
<span class="r-in">    <span class="fu"><a href="xmdb.html">xmdb</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"tbl_Hyd"</span>, <span class="st">"Zeitst"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Q"</span>, <span class="st">"v"</span><span class="op">)</span>, <span class="st">"2011-08-24"</span>, <span class="st">"2011-08-25"</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="co">## Show the last records of the returned dataset.</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in">   </span>
<span class="r-in"><span class="co">## Output:</span></span>
<span class="r-in"><span class="co">#                   Zeitst     Q     v</span></span>
<span class="r-in"><span class="co"># 1435 2011-08-24 23:55:00 0.638 0.281</span></span>
<span class="r-in"><span class="co"># 1436 2011-08-24 23:56:00 0.601 0.265</span></span>
<span class="r-in"><span class="co"># 1437 2011-08-24 23:57:00 0.564 0.249</span></span>
<span class="r-in"><span class="co"># 1438 2011-08-24 23:58:00 0.536 0.237</span></span>
<span class="r-in"><span class="co"># 1439 2011-08-24 23:59:00 0.504 0.223</span></span>
<span class="r-in"><span class="co"># 1440 2011-08-25 00:00:00 0.483 0.214</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="http://github.com/hsonne" class="external-link">Hauke Sonnenberg</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'a2909cc57c21696b653e1258dfa00c5c',
    indexName: 'kwb_db',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

