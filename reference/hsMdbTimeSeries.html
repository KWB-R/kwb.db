<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Reads time-series data from an MS Access database table and returns a data
frame containing the data. The name of the timestamp field must be given in
tsField and the names of the value fields to be selected from the
table must be given in vector fields. Instead of an ODBC channel the
name of the database must be given. This function takes care that the
timestamps are transferred correctly between MS Access and R by requesting
date and time information separately from MS Access and putting both together
to a POSIXct object in UTC timezone. This is necessary because with very long
data sets the RODBC function sqlQuery (or the function
hsSqlQuery that calls this function) may deliver timestamps in
which time information is lacking!"><title>Get Mdb time series in UTC — hsMdbTimeSeries • kwb.db</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get Mdb time series in UTC — hsMdbTimeSeries"><meta property="og:description" content="Reads time-series data from an MS Access database table and returns a data
frame containing the data. The name of the timestamp field must be given in
tsField and the names of the value fields to be selected from the
table must be given in vector fields. Instead of an ODBC channel the
name of the database must be given. This function takes care that the
timestamps are transferred correctly between MS Access and R by requesting
date and time information separately from MS Access and putting both together
to a POSIXct object in UTC timezone. This is necessary because with very long
data sets the RODBC function sqlQuery (or the function
hsSqlQuery that calls this function) may deliver timestamps in
which time information is lacking!"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">kwb.db</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.6.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/KWB-R/kwb.db/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Get Mdb time series in UTC</h1>
      <small class="dont-index">Source: <a href="https://github.com/KWB-R/kwb.db/blob/HEAD/R/main.R" class="external-link"><code>R/main.R</code></a></small>
      <div class="d-none name"><code>hsMdbTimeSeries.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Reads time-series data from an MS Access database table and returns a data
frame containing the data. The name of the timestamp field must be given in
<em>tsField</em> and the names of the value fields to be selected from the
table must be given in vector <em>fields</em>. Instead of an ODBC channel the
name of the database must be given. This function takes care that the
timestamps are transferred correctly between MS Access and R by requesting
date and time information separately from MS Access and putting both together
to a POSIXct object in UTC timezone. This is necessary because with very long
data sets the RODBC function sqlQuery (or the function
<code><a href="hsSqlQuery.html">hsSqlQuery</a></code> that calls this function) may deliver timestamps in
which time information is lacking!</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">hsMdbTimeSeries</span><span class="op">(</span>
  <span class="va">mdb</span>,
  <span class="va">tbl</span>,
  tsField <span class="op">=</span> <span class="fu"><a href="hsTsField.html">hsTsField</a></span><span class="op">(</span><span class="va">mdb</span>, <span class="va">tbl</span><span class="op">)</span>,
  fields <span class="op">=</span> <span class="st">"*"</span>,
  minDate <span class="op">=</span> <span class="cn">NULL</span>,
  maxDate <span class="op">=</span> <span class="cn">NULL</span>,
  resolution <span class="op">=</span> <span class="st">"min"</span>,
  inclLast <span class="op">=</span> <span class="cn">TRUE</span>,
  sqlFilter <span class="op">=</span> <span class="st">"TRUE"</span>,
  dbg <span class="op">=</span> <span class="cn">FALSE</span>,
  calcType <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>mdb</dt>
<dd><p>Full path to MS Access database file (*.mdb)</p></dd>
<dt>tbl</dt>
<dd><p>Name of table containing the time-series data.</p></dd>
<dt>tsField</dt>
<dd><p>Name of table field containing the timestamps.</p></dd>
<dt>fields</dt>
<dd><p>Vector containing names of value fields to be selected from the
table. This vector may or may not contain the name of the timetamp field.</p></dd>
<dt>minDate</dt>
<dd><p>Minimum date (and time) of time interval to be selected in
ISO-Syntax: yyyy-mm-dd [HH:MM:SS], where the part in brackets in optional.</p></dd>
<dt>maxDate</dt>
<dd><p>Day following the maximum date of the time interval to be
selected, in ISO-Syntax: yyyy-mm-dd [HH:MM:SS], where the part in brackets
in optional.</p></dd>
<dt>resolution</dt>
<dd><p>time resolution: “min” = minutes, “s” =
seconds. If time resolution is “min” timestamps are rounded to the
next full minute.</p></dd>
<dt>inclLast</dt>
<dd><p>If TRUE, <em>maxDate</em> will be included in result data set,
else excluded.</p></dd>
<dt>sqlFilter</dt>
<dd><p>additional SQL filter criterion</p></dd>
<dt>dbg</dt>
<dd><p>if TRUE, debug messages are shown</p></dd>
<dt>calcType</dt>
<dd><p>for internal use only, do not change!</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>data.frame with POSIXct timestamp column &lt;strTimestamp&gt; (UTC time
  zone) and value columns as selected in &lt;strFieldList&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="hsGetTimeSeries.html">hsGetTimeSeries</a>, <a href="hsGetTable.html">hsGetTable</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co">## Get flow time series of 24 of August 2011 from tbl_Hyd in example database</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"windows"</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu">hsMdbTimeSeries</span><span class="op">(</span></span>
<span class="r-in">    <span class="fu"><a href="xmdb.html">xmdb</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"tbl_Hyd"</span>, <span class="st">"Zeitst"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Q"</span>, <span class="st">"v"</span><span class="op">)</span>, <span class="st">"2011-08-24"</span>, <span class="st">"2011-08-25"</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="co">## Show the last records of the returned dataset.</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in">   </span>
<span class="r-in"><span class="co">## Output:</span></span>
<span class="r-in"><span class="co">#                   Zeitst     Q     v</span></span>
<span class="r-in"><span class="co"># 1435 2011-08-24 23:55:00 0.638 0.281</span></span>
<span class="r-in"><span class="co"># 1436 2011-08-24 23:56:00 0.601 0.265</span></span>
<span class="r-in"><span class="co"># 1437 2011-08-24 23:57:00 0.564 0.249</span></span>
<span class="r-in"><span class="co"># 1438 2011-08-24 23:58:00 0.536 0.237</span></span>
<span class="r-in"><span class="co"># 1439 2011-08-24 23:59:00 0.504 0.223</span></span>
<span class="r-in"><span class="co"># 1440 2011-08-25 00:00:00 0.483 0.214</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://github.com/hsonne" class="external-link">Hauke Sonnenberg</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

