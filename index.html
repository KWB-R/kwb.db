<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Functions supporting data base access • kwb.db</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><!-- docsearch --><script src="docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Functions supporting data base access">
<meta property="og:description" content="This package contains some useful functions, especially for
    simplifying data transfer between MS Access databases and R. With the
    functions of this package it is not needed any more to open and close
    a database connection explicitely; this is done behind the scenes in
    the functions. Instead of a database connection the path to the
    database file needs to be passed to the functions as an argument. The
    main functions are hsGetTable and hsPutTable which transfer data from
    an MS Access database to a data frame in R and save data from a data
    frame in R into a table in an MS Access database, respectively. Take
    care when getting time series data from an MS Access database, see
    therefore hsMdbTimeSeries. Use hsTables to get a list of tables that
    are available in a database and hsFields to get a list of table fields
    that are contained in a database table.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">kwb.db</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/KWB-R/kwb.db/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<p>This repository contains the R package kwb.db. The package provides functions that aim at simplifying the data transfer between databases and R. It is based on the <a href="https://cran.r-project.org/web/packages/RODBC/" class="external-link">RODBC</a> package that gives access to databases that provide an <a href="https://docs.microsoft.com/en-us/sql/odbc/reference/what-is-odbc" class="external-link">ODBC</a> interface. Databases may be Microsoft Access files, Microsoft Excel files or any other database that is registered as an ODBC data source on your local machine. See e.g. <a href="https://docs.microsoft.com/en-us/sql/odbc/admin/odbc-data-source-administrator" class="external-link">here</a> for how to setup ODBC data sources in Windows.</p>
<div class="section level1">
<div class="page-header"><h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1></div>
<p>Once you have the devtools package installed, you can install the package kwb.db like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># If required, install the devtools package...</span>
<span class="co"># install.packages("devtools")</span>

<span class="co"># Install kwb.db (and dependent packages) from this GitHub repository</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"kwb-r/kwb.db"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="database-access-in-rodbc">Database Access in RODBC<a class="anchor" aria-label="anchor" href="#database-access-in-rodbc"></a>
</h2>
<p>With the RODBC package, you need to open a database connection, send one or more requests to the database and finally close the database connection.</p>
</div>
<div class="section level2">
<h2 id="database-access-with-this-package">Database Access with this package<a class="anchor" aria-label="anchor" href="#database-access-with-this-package"></a>
</h2>
<p>With the functions of this package it is not needed to open and close a database connection explicitly; this is done behind the scenes in the functions. Instead of a database connection the path to the database file needs to be passed to the functions as an argument.</p>
<p>The main functions are <code><a href="reference/hsGetTable.html">hsGetTable()</a></code> and <code><a href="reference/hsPutTable.html">hsPutTable()</a></code>. They transfer data from a database to a data frame in R and save data from a data frame in R into a new table in a database, respectively.</p>
<p>Use <code><a href="reference/hsTables.html">hsTables()</a></code> to get a list of tables that are available in a database and <code><a href="reference/hsFields.html">hsFields()</a></code> to get a list of table fields that are contained in a database table.</p>
<p>A general workflow could look like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Define the path to a MS Access datbase file</span>
<span class="va">mdb</span> <span class="op">&lt;-</span> <span class="st">"/path/to/your/database.mdb"</span>

<span class="co"># Have a look at what tables are contained in the database</span>
<span class="op">(</span><span class="va">tables</span> <span class="op">&lt;-</span> <span class="fu">kwb.db</span><span class="fu">::</span><span class="fu"><a href="reference/hsTables.html">hsTables</a></span><span class="op">(</span><span class="va">mdb</span><span class="op">)</span><span class="op">)</span>

<span class="co"># For each table, get the vector of available fields (= columns)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tables</span>, <span class="fu">kwb.db</span><span class="fu">::</span><span class="va"><a href="reference/hsFields.html">hsFields</a></span>, mdb <span class="op">=</span> <span class="va">mdb</span><span class="op">)</span>

<span class="co"># Get the content of the first table</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">kwb.db</span><span class="fu">::</span><span class="fu"><a href="reference/hsGetTable.html">hsGetTable</a></span><span class="op">(</span><span class="va">mdb</span>, <span class="va">tables</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>

<span class="co"># Do some modifiactions or create somehow else a new data frame</span>
<span class="va">data_new</span> <span class="op">&lt;-</span> <span class="fu">do_some_fancy_stuff</span><span class="op">(</span><span class="va">data</span><span class="op">)</span>

<span class="co"># Save the new data frame as a new "fancy_table" in the database</span>
<span class="fu">kwb.db</span><span class="fu">::</span><span class="fu"><a href="reference/hsPutTable.html">hsPutTable</a></span><span class="op">(</span><span class="va">mdb</span>, <span class="va">data_new</span>, <span class="st">"fancy_table"</span><span class="op">)</span></code></pre></div>
<p>In each of the <code>kwb.db::</code>-function calls above a database connection is opened, a request to the database is sent and the connection is closed again. Thus, the user does not have to care about open database connections.</p>
<p>Take care when getting time series data from an MS Access database, see therefore <code><a href="reference/hsMdbTimeSeries.html">hsMdbTimeSeries()</a></code>.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/KWB-R/kwb.db/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/KWB-R/kwb.db/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing kwb.db</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="http://github.com/hsonne" class="external-link">Hauke Sonnenberg</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-9134-2871" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/KWB-R/kwb.db/actions?query=workflow%3AR-CMD-check" class="external-link"><img src="https://github.com/KWB-R/kwb.db/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://github.com/KWB-R/kwb.db/actions?query=workflow%3Apkgdown" class="external-link"><img src="https://github.com/KWB-R/kwb.db/workflows/pkgdown/badge.svg" alt="pkgdown"></a></li>
<li><a href="https://codecov.io/github/KWB-R/kwb.db" class="external-link"><img src="https://codecov.io/github/KWB-R/kwb.db/branch/master/graphs/badge.svg" alt="codecov"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="lifecycle"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="http://github.com/hsonne" class="external-link">Hauke Sonnenberg</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'a2909cc57c21696b653e1258dfa00c5c',
    indexName: 'kwb_db',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
