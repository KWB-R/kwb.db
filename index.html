<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="This package contains some useful functions, especially for
    simplifying data transfer between MS Access databases and R. With the
    functions of this package it is not needed any more to open and close
    a database connection explicitely; this is done behind the scenes in
    the functions. Instead of a database connection the path to the
    database file needs to be passed to the functions as an argument. The
    main functions are hsGetTable and hsPutTable which transfer data from
    an MS Access database to a data frame in R and save data from a data
    frame in R into a table in an MS Access database, respectively. Take
    care when getting time series data from an MS Access database, see
    therefore hsMdbTimeSeries. Use hsTables to get a list of tables that
    are available in a database and hsFields to get a list of table fields
    that are contained in a database table.">
<title>Functions supporting data base access • kwb.db</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Functions supporting data base access">
<meta property="og:description" content="This package contains some useful functions, especially for
    simplifying data transfer between MS Access databases and R. With the
    functions of this package it is not needed any more to open and close
    a database connection explicitely; this is done behind the scenes in
    the functions. Instead of a database connection the path to the
    database file needs to be passed to the functions as an argument. The
    main functions are hsGetTable and hsPutTable which transfer data from
    an MS Access database to a data frame in R and save data from a data
    frame in R into a table in an MS Access database, respectively. Take
    care when getting time series data from an MS Access database, see
    therefore hsMdbTimeSeries. Use hsTables to get a list of tables that
    are available in a database and hsFields to get a list of table fields
    that are contained in a database table.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">kwb.db</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.6.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/KWB-R/kwb.db/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<p>This repository contains the R package kwb.db. The package provides functions that aim at simplifying the data transfer between databases and R. It is based on the <a href="https://cran.r-project.org/web/packages/RODBC/" class="external-link">RODBC</a> package that gives access to databases that provide an <a href="https://docs.microsoft.com/en-us/sql/odbc/reference/what-is-odbc" class="external-link">ODBC</a> interface. Databases may be Microsoft Access files, Microsoft Excel files or any other database that is registered as an ODBC data source on your local machine. See e.g. <a href="https://docs.microsoft.com/en-us/sql/odbc/admin/odbc-data-source-administrator" class="external-link">here</a> for how to setup ODBC data sources in Windows.</p>
<div class="section level1">
<div class="page-header"><h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1></div>
<p>Once you have the devtools package installed, you can install the package kwb.db like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># If required, install the devtools package...</span>
<span class="co"># install.packages("devtools")</span>

<span class="co"># Install kwb.db (and dependent packages) from this GitHub repository</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"kwb-r/kwb.db"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="database-access-in-rodbc">Database Access in RODBC<a class="anchor" aria-label="anchor" href="#database-access-in-rodbc"></a>
</h2>
<p>With the RODBC package, you need to open a database connection, send one or more requests to the database and finally close the database connection.</p>
</div>
<div class="section level2">
<h2 id="database-access-with-this-package">Database Access with this package<a class="anchor" aria-label="anchor" href="#database-access-with-this-package"></a>
</h2>
<p>With the functions of this package it is not needed to open and close a database connection explicitly; this is done behind the scenes in the functions. Instead of a database connection the path to the database file needs to be passed to the functions as an argument.</p>
<p>The main functions are <code><a href="reference/hsGetTable.html">hsGetTable()</a></code> and <code><a href="reference/hsPutTable.html">hsPutTable()</a></code>. They transfer data from a database to a data frame in R and save data from a data frame in R into a new table in a database, respectively.</p>
<p>Use <code><a href="reference/hsTables.html">hsTables()</a></code> to get a list of tables that are available in a database and <code><a href="reference/hsFields.html">hsFields()</a></code> to get a list of table fields that are contained in a database table.</p>
<p>A general workflow could look like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Define the path to a MS Access datbase file</span>
<span class="va">mdb</span> <span class="op">&lt;-</span> <span class="st">"/path/to/your/database.mdb"</span>

<span class="co"># Have a look at what tables are contained in the database</span>
<span class="op">(</span><span class="va">tables</span> <span class="op">&lt;-</span> <span class="fu">kwb.db</span><span class="fu">::</span><span class="fu"><a href="reference/hsTables.html">hsTables</a></span><span class="op">(</span><span class="va">mdb</span><span class="op">)</span><span class="op">)</span>

<span class="co"># For each table, get the vector of available fields (= columns)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tables</span>, <span class="fu">kwb.db</span><span class="fu">::</span><span class="va"><a href="reference/hsFields.html">hsFields</a></span>, mdb <span class="op">=</span> <span class="va">mdb</span><span class="op">)</span>

<span class="co"># Get the content of the first table</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">kwb.db</span><span class="fu">::</span><span class="fu"><a href="reference/hsGetTable.html">hsGetTable</a></span><span class="op">(</span><span class="va">mdb</span>, <span class="va">tables</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>

<span class="co"># Do some modifiactions or create somehow else a new data frame</span>
<span class="va">data_new</span> <span class="op">&lt;-</span> <span class="fu">do_some_fancy_stuff</span><span class="op">(</span><span class="va">data</span><span class="op">)</span>

<span class="co"># Save the new data frame as a new "fancy_table" in the database</span>
<span class="fu">kwb.db</span><span class="fu">::</span><span class="fu"><a href="reference/hsPutTable.html">hsPutTable</a></span><span class="op">(</span><span class="va">mdb</span>, <span class="va">data_new</span>, <span class="st">"fancy_table"</span><span class="op">)</span></code></pre></div>
<p>In each of the <code>kwb.db::</code>-function calls above a database connection is opened, a request to the database is sent and the connection is closed again. Thus, the user does not have to care about open database connections.</p>
<p>Take care when getting time series data from an MS Access database, see therefore <code><a href="reference/hsMdbTimeSeries.html">hsMdbTimeSeries()</a></code>.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/KWB-R/kwb.db/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/KWB-R/kwb.db/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing kwb.db</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://github.com/hsonne" class="external-link">Hauke Sonnenberg</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-9134-2871" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/KWB-R/kwb.db/actions?query=workflow%3AR-CMD-check" class="external-link"><img src="https://github.com/KWB-R/kwb.db/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://github.com/KWB-R/kwb.db/actions?query=workflow%3Apkgdown" class="external-link"><img src="https://github.com/KWB-R/kwb.db/workflows/pkgdown/badge.svg" alt="pkgdown"></a></li>
<li><a href="https://codecov.io/github/KWB-R/kwb.db" class="external-link"><img src="https://codecov.io/github/KWB-R/kwb.db/branch/master/graphs/badge.svg" alt="codecov"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="lifecycle"></a></li>
<li><a href="http://www.r-pkg.org/pkg/KWB-R/kwb.db" class="external-link"><img src="http://www.r-pkg.org/badges/version/KWB-R/kwb.db" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://kwb-r.r-universe.dev/" class="external-link"><img src="https://kwb-r.r-universe.dev/badges/kwb.db" alt="R-Universe_Status_Badge"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/hsonne" class="external-link">Hauke Sonnenberg</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
