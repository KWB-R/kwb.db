<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Send SQL Query to Database — hsSqlQuery • kwb.db</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Send SQL Query to Database — hsSqlQuery" />

<meta property="og:description" content="Get data from database requested via an SQL query. This function performs
opening of the connection, data retieval via SQL and closing of the
connection.  If an error occurs the program stops and an error description is
shown." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">kwb.db</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/KWB-R/kwb.db">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Send SQL Query to Database</h1>
    <small class="dont-index">Source: <a href='https://github.com/KWB-R/kwb.db/blob/master/R/main.R'><code>R/main.R</code></a></small>
    <div class="hidden name"><code>hsSqlQuery.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Get data from database requested via an SQL query. This function performs
opening of the connection, data retieval via SQL and closing of the
connection.  If an error occurs the program stops and an error description is
shown.</p>
    
    </div>

    <pre class="usage"><span class='fu'>hsSqlQuery</span>(<span class='no'>mdb</span>, <span class='no'>sql</span>, <span class='kw'>use2007Driver</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>dbg</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>stopOnError</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>DBMSencoding</span> <span class='kw'>=</span> <span class='st'>""</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mdb</th>
      <td><p>full path to MS Access database file (extension &#8220;.mdb&#8221; or 
&#8220;.accdb&#8221;) or MS Excel file (extension &#8220;.xls&#8221; or 
&#8220;.xlsx&#8221;).</p></td>
    </tr>
    <tr>
      <th>sql</th>
      <td><p>SQL query</p></td>
    </tr>
    <tr>
      <th>use2007Driver</th>
      <td><p>if TRUE the functions odbcConnectAccess2007 and
odbcConnectExcel2007 are used instead of odbcConnectAccess and
odbcConnectExcel, respectively</p></td>
    </tr>
    <tr>
      <th>dbg</th>
      <td><p>if TRUE (default), debug messages are shown.</p></td>
    </tr>
    <tr>
      <th>stopOnError</th>
      <td><p>if TRUE (default), the program stops in case of an error,
otherwise a warning is shown and NULL is returned.</p></td>
    </tr>
    <tr>
      <th>DBMSencoding</th>
      <td><p>finally passed to <code>odbcDriverConnect</code>. Default: "",
You may want to use: "UTF-8"</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>additional arguments to be passed to <code>sqlQuery</code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>On success, a data.frame containing the data that is internally
  requested by calling the RODBC function sqlQuery and that is provided by
  the database is returned.  On error R stops execution and does not return
  anything.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='hsPutTable.html'>hsPutTable</a>, <a href='hsGetTable.html'>hsGetTable</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'>## Get Q time series from table "tbl_Hyd" in example database</span>

<span class='kw'>if</span> (<span class='no'>.Platform</span>$<span class='no'>OS.type</span> <span class='kw'>==</span> <span class='st'>"windows"</span>) {

  <span class='no'>tsQ</span> <span class='kw'>&lt;-</span> <span class='fu'>hsSqlQuery</span>(
    <span class='fu'><a href='xmdb.html'>xmdb</a></span>(), <span class='st'>"SELECT Zeitst AS t, Q FROM tbl_Hyd WHERE Q &gt; 1.0"</span>
  )

  <span class='co'>## Show the first lines of the resulting data.frame</span>
  <span class='fu'>head</span>(<span class='no'>tsQ</span>)
}

<span class='co'>## Output</span>
<span class='co'># t     Q</span>
<span class='co'># 1 2011-08-24 22:27:00 1.061</span>
<span class='co'># 2 2011-08-24 22:28:00 1.091</span>
<span class='co'># 3 2011-08-24 22:29:00 1.115</span>
<span class='co'># 4 2011-08-24 22:30:00 1.092</span>
<span class='co'># 5 2011-08-24 22:31:00 1.086</span>
<span class='co'># 6 2011-08-24 22:32:00 1.074</span>
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Hauke Sonnenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

