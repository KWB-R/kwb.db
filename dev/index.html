<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Functions supporting data base access • kwb.db</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><!-- docsearch --><script src="docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Functions supporting data base access">
<meta property="og:description" content="This package contains some useful functions, especially for 
    simplifying data transfer between MS Access databases and R. With the 
    functions of this package it is not needed any more to open and close a 
    database connection explicitely; this is done behind the scenes in the 
    functions. Instead of a database connection the path to the database file
    needs to be passed to the functions as an argument. The main functions are 
    hsGetTable and hsPutTable which transfer data from an MS Access database to 
    a data frame in R and save data from a data frame in R into a table in an MS 
    Access database, respectively. Take care when getting time series data from 
    an MS Access database, see therefore hsMdbTimeSeries. Use hsTables to get a 
    list of tables that are available in a database and hsFields to get a list 
    of table fields that are contained in a database table.">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">kwb.db</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/KWB-R/kwb.db">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<p>This repository contains the R package kwb.db. The package provides functions that aim at simplifying the data transfer between databases and R. It is based on the <a href="https://cran.r-project.org/web/packages/RODBC/">RODBC</a> package that gives access to databases that provide an <a href="https://docs.microsoft.com/en-us/sql/odbc/reference/what-is-odbc">ODBC</a> interface. Databases may be Microsoft Access files, Microsoft Excel files or any other database that is registered as an ODBC data source on your local machine. See e.g. <a href="https://docs.microsoft.com/en-us/sql/odbc/admin/odbc-data-source-administrator">here</a> for how to setup ODBC data sources in Windows.</p>
<div id="installation" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1></div>
<p>Once you have the devtools package installed, you can install the package kwb.db like this:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># If required, install the devtools package...</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># Install kwb.db (and dependent packages) from this GitHub repository</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"kwb-r/kwb.db"</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div id="database-access-in-rodbc" class="section level2">
<h2 class="hasAnchor">
<a href="#database-access-in-rodbc" class="anchor"></a>Database Access in RODBC</h2>
<p>With the RODBC package, you need to open a database connection, send one or more requests to the database and finally close the dabase connection.</p>
</div>
<div id="database-access-with-this-package" class="section level2">
<h2 class="hasAnchor">
<a href="#database-access-with-this-package" class="anchor"></a>Database Access with this package</h2>
<p>With the functions of this package it is not needed to open and close a database connection explicitly; this is done behind the scenes in the functions. Instead of a database connection the path to the database file needs to be passed to the functions as an argument.</p>
<p>The main functions are <a href="https://kwb-r.github.io/kwb.db/reference/hsGetTable.html"><code><a href="reference/hsGetTable.html">hsGetTable()</a></code></a> and <a href="https://kwb-r.github.io/kwb.db/reference/hsPutTable.html"><code><a href="reference/hsPutTable.html">hsPutTable()</a></code></a>. They transfer data from a database to a data frame in R and save data from a data frame in R into a new table in a database, respectively.</p>
<p>Use <a href="https://kwb-r.github.io/kwb.db/reference/hsTables.html"><code><a href="reference/hsTables.html">hsTables()</a></code></a> to get a list of tables that are available in a database and <a href="https://kwb-r.github.io/kwb.db/reference/hsFields.html"><code><a href="reference/hsFields.html">hsFields()</a></code></a> to get a list of table fields that are contained in a database table.</p>
<p>A general workflow could look like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Define the path to a MS Access datbase file</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">mdb &lt;-<span class="st"> "/path/to/your/database.mdb"</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co"># Have a look at what tables are contained in the database</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">(tables &lt;-<span class="st"> </span>kwb.db<span class="op">::</span><span class="kw">hsTables</span>(mdb))</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co"># For each table, get the vector of available fields (= columns)</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(tables, kwb.db<span class="op">::</span>hsFields, <span class="dt">mdb =</span> mdb)</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co"># Get the content of the first table</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11">data &lt;-<span class="st"> </span>kwb.db<span class="op">::</span><span class="kw">hsGetTable</span>(mdb, tables[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb2-12" data-line-number="12"></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co"># Do some modifiactions or create somehow else a new data frame</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14">data_new &lt;-<span class="st"> </span><span class="kw">do_some_fancy_stuff</span>(data)</a>
<a class="sourceLine" id="cb2-15" data-line-number="15"></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co"># Save the new data frame as a new "fancy_table" in the database</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17">kwb.db<span class="op">::</span><span class="kw">hsPutTable</span>(mdb, data_new, <span class="st">"fancy_table"</span>)</a></code></pre></div>
<p>In each of the <code>kwb.db::</code>-function calls above a database connection is opened, a request to the database is sent and the connection is closed again. Thus, the user does not have to care about open database connections.</p>
<p>Take care when getting time series data from an MS Access database, see therefore <a href="https://kwb-r.github.io/kwb.db/reference/hsMdbTimeSeries.html"><code><a href="reference/hsMdbTimeSeries.html">hsMdbTimeSeries()</a></code></a>.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/KWB-R/kwb.db">https://​github.com/​KWB-R/​kwb.db</a>
</li>
<li>Report a bug at <br><a href="https://github.com/KWB-R/kwb.db/issues">https://​github.com/​KWB-R/​kwb.db/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Hauke Sonnenberg <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-9134-2871" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://ci.appveyor.com/project/KWB-R/kwb-db/branch/master"><img src="https://ci.appveyor.com/api/projects/status/m70gtm2010x6hnqi/branch/master?svg=true" alt="Appveyor build status"></a></li>
<li><a href="https://travis-ci.org/KWB-R/kwb.db"><img src="https://travis-ci.org/KWB-R/kwb.db.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://codecov.io/github/KWB-R/kwb.db"><img src="https://codecov.io/github/KWB-R/kwb.db/branch/master/graphs/badge.svg" alt="codecov"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#stable"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="lifecycle"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Hauke Sonnenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'a2909cc57c21696b653e1258dfa00c5c',
    indexName: 'kwb_db',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
